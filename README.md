# autoencoder_intruder_detection

열감지 센서를 이용하는 침입자 감지 시스템들은 많이 연구되었지만 이는 단순한 침입 감지로 인하여 침입자를 구분하는 것일 뿐 침입자와 거주자의 차이를 구분하지 못한다. 본 논문에서는 열감지 센서의 온 도 데이터를 LSTM AutoEncoder를 이용하여 학습한 모델로 거주자와 침입자의 다른 이동패턴을 파악하고 침입자를 보다 정확하게 구분하고자 한다. 침입자 감지 모델의 성능을 향상시키기 위하여 모델의 epochs, LSTM AutoEncoder의 입력층 구조, 슬라이딩 윈도우 등의 변화를 통하여 가장 좋은 모델을 찾고 이를 이 용하여 침입자를 보다 정확하게 구분한다. 가장 좋은 침입자 감지 모델을 이용하여 침입자가 침입하였을 경우 모델은 침입자를 인식하고 거주자의 핸드폰으로 알림을 보내도록 구성한다.

1.서 론
열감지 센서를 이용한 기존 연구 및 사례들은 Beacon 통신을사용하거나열선과영상센서두가지를모두사 용하여 침입자를 판단하는 시스템들이 있다. 그러나 이 러한 방법들은 스마트폰이 강제된다는 단점과 열선과 영 상 센서 모두를 사용하여 비용이 많이 소모된다는 단점 이 존재한다. 이러한 단점들을 해결하고 편리성 향상을 위해 열감지 센서만으로 침입자를 효과적으로 판단할 수 있는 연구를 진행하고자 한다.
엄진웅 외 3인의 연구에서는 방에 설치된 열감지 센서 와 LSTM AutoEncoer를 이용하여 거주자와 침입자 구분 시스템을 개발하고자 한다. LSTM AutoEncoer 기반 이상 시퀀스 탐지 기법은 참고 문헌[1]을 참고하여 거주자의 일상적인 이동 패턴을 이용하여 학습하고 학습한 모델을 이용하여 훈련되지 않는 이동패턴이 감지될 경우 침입자 로 판단하고 거주자에게 알림을 보내게 된다.


2. 하드웨어 설계
라즈베리파이4(Raspberry Pi 4 Model B) 4GB, 열감지 센서(Adafruit AMG8833 IR Thermal Camera Breakout [ada-3538]), 라즈베리파이4 5V 알래스카 듀얼팬 키트 (SZH-RPI02), 라즈베리파이 전원 어댑터와 male-female 선으로 구성된다.
라즈베리파이4의 1번(power), 3번(SDA), 5번(SCL), 9번 (Ground) 핀에 열감지 센서의 VIN, SDA, SCL, GND를 동 일하게 연결한다. 4번과 6번핀에 듀얼팬 키트를 연결한 다. 듀얼팬 키트와 방열판을 사용함으로써 라즈베리파이
4의장시간사용에도기기의과열을방지할수있다.라 즈베리파이4에 라즈비안 os를 설치하고 노트북과 라즈베 리파이4를 Micro HDMI to HDMI Cable을 사용하여 연결 시킨 후 노트북에서 라즈베리파이4를 사용하게 한다.
라즈베리파이4에 Adafruit Python GPIO 라이브러리를 설치하고 라이브러리 폴더에 있는 thermal_cam.py와 pixels_test.py를 실행하여 열감지 센서로 초당 8 x 8 개 의온도값들을확인하고열감지센서화면을확인할수 있다.
딥러닝을 수행한 모델로 실시간 데이터를 판단하는데 이때true값이6개이상이나오게되면침입자로판단 하여 거주자의 휴대폰에 실시간 침입자 감지 알림을 보 낸다.


3. 데이터 가공
Real-time 침입자 감지를 위해서 실시간으로 저장되는 열감지 센서의 데이터 값을 데이터베이스 서버에 전송 및저장한다.전송할때의데이터값은1초마다8x8 개의값을가진한개의1차원리스트를전송한다.추후 에 1초마다 전송되는 대량의 데이터들을 저장시키기 위 해 개인 서버가 아닌 firebase Real-time Database를 서 버로 사용한다.
자세한 데이터 가공 내용은 본문 3.1에 기재. 본문 3.1 과 본문 3.2를 진행할 시 20초동안 쌓인 데이터(64개 x 20초)가 한 개의 리스트에 저장되며 이 저장된 리스트를 테스트 데이터로 사용해 침입자 감지를 수행한다.


3.1 실시간 데이터 가공
실시간으로 침입자를 감지하는 프로그램에서 firebase Real-time Database 서버를 통해 실시간으로 계속 저장 되는 데이터를 전달받는다. 이 데이터 값들은 dict 형식 으로 전달 받으며 이를 날짜는 key로 그에 맞는 데이터 값은 value로 저장한다. 저장할 때의 데이터는 가장 최근 의 데이터 30개를 가져온다. 이는 본문 3.2에 기재된 슬 라이딩 윈도우를 위함이며 데이터 손실을 막기 위함이 다.
날짜와 데이터 값으로 데이터 프레임 생성 후 구분자 를 없애기 위한 가공을 진행한다.
3.2 슬라이딩 윈도우
슬라이딩 윈도우는 참고문헌 [2]을 참고하였으며 [2]에 서 사용한 방법을 본 연구의 데이터에 맞게 수정 후 사 용하였다. 슬라이딩 윈도우를 진행할 때 원본 데이터와 가공할 데이터 형식, lookback를 파라미터로 제공받는다. 여기서 lookback은 윈도우 사이즈이며 본 연구의 목적인 이동 패턴 학습의 정확성을 위해 실제 진행한 실험에서 는 윈도우 사이즈를 20으로 지정한 후 실험을 진행하였 다. 슬라이딩 윈도우를 수행할 때는 pandas 패키지의 shift를 사용해 간단하고 효율적인 슬라이딩을 진행하였 다.
그림으로 표현하면 <그림1>과 같으며, 후에 생성되는 데 이터의 앞 20개의 데이터는 NULL값이 존재하므로, 삭제 해준다.

![image](https://user-images.githubusercontent.com/79649052/124240344-9f861600-db55-11eb-8f36-6c04ad5d5f9c.png)


4. 딥러닝 모델 구조 비교
모델의 원활한 비교를 위해 batch size는 20으로 고정 하였고, 훈련 데이터는 거주자의 일상 생활 30분을 사용 하고, 테스트 데이터로는 과장된 침입자 데이터 3분을 사용한다.
epochs, LSTM AutoEncoder의 입력층 구조, 슬라이딩 윈도우를 통해 가장 최적의 모델을 찾기 위해 다양한 경 우를 비교해 보았다.
<표1>은 과정에서 유의미한 비교군으로 구성한다

![image](https://user-images.githubusercontent.com/79649052/124240396-add43200-db55-11eb-97f6-4b55d0464d0b.png)

슬라이딩 윈도우를 함과 동시에 LSTM 입력층의 셀 개 수를 확장 시켜주는 게 더 좋은 성능이 나타남에 따라 증명되었다.

![image](https://user-images.githubusercontent.com/79649052/124240533-c9d7d380-db55-11eb-96f2-17d3d84e21ed.png)

<그림2>는 침입자 행동의 초기 부분만 잘 감지할 뿐 그 이후의 결과는 잘 감지하지 못하는 결과가 나타난다. <그림3>는 침입자 데이터가 잘 감지되지만 <그림4>과 비교했을 때 <그림3>이 훨씬 높은 임계값 차이로 침입자
를 더 정확하게 판단하는 모델이라고 볼 수 있다.

![image](https://user-images.githubusercontent.com/79649052/124240582-d5c39580-db55-11eb-9223-80f0f79eb244.png)

![image](https://user-images.githubusercontent.com/79649052/124240610-de1bd080-db55-11eb-99d3-9b303ac5a8b8.png)


<그림4>와 <그림5>을 비교해 보았을때, <표1>의 마지 막 모델은 과적합(overfitting)이 일어났다는 것을 확인할 수 있다. 150을 넘어가면 과적합이 발생하여 epochs는 100에서 150사이가 가장 적합하다. 후에 거주자와 행동 이 비슷한 침입자 감지와 실시간 감지 시에는 슬라이딩 윈도우 수행 시 윈도우 사이즈를 20으로 LSTM 모델의 입력층은 1280-320, 드랍아웃 0.3으로 설정하였다.
5. 향후 연구 및 결론
본 논문에서는 열감지 센서와 LSTM AutoEncoder를 활 용한 실시간 침입자 감지 시스템을 데이터 가공 기법과 모델 구조의 다양화를 통하여 최적을 모델을 선정할 수 있도록 분석하였다. 또한 분석한 결과를 토대로 실시간 침입자 감지 시 정확한 판단을 할 수 있도록 연구하였 다.
향후 연구로는 모델 구조의 다양화를 통해 최적의 모 델을 훈련하여 더 정확하고 신속한 판단을 할 수 있도록 연구할 계획이다.
참고문헌
[1] 이주연, 이기용 "확장된 LSTM 오토인코더 기반 이상 시퀀스 탐지 기법" 한국전자거래학회지 v.26 no.1 , 2021 년, pp.127 - 140
[2] JAGADEESH23, Multivariate Multi-step Time Series Forecasting using Stacked LSTM sequence to sequence Autoencoder in Tensorflow 2.0 / Keras, Analytics Vidhya, 2020.
